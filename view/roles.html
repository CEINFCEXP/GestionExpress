{% extends "components/layout.html" %}

{% block title %}
    Gestión de Roles
{% endblock %}

{% block head %}
    <!-- Incluyendo los estilos de Bootstrap y Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}

{% block content %}
<div class="container-fluid mt-auto mb-auto">
    <!-- Encabezado -->
    <div class="row justify-content-between align-items-center mb-4">
        <h1 class="col-auto" style="font-size: 22px; font-family: 'Century Gothic', sans-serif;">Gestión de Roles</h1>
        <h1 class="col-auto" style="font-size: 14px; font-family: 'Century Gothic', sans-serif;">¡Hola, {{ user_session.nombres }} {{ user_session.apellidos }}!</h1>
        <img src="/static/Consorcio.png" alt="Consorcio Icon" class="col-auto" style="max-width: 100px; height: auto;">
    </div>

    <!-- Contenedor principal dividido en dos secciones -->
    <div class="row">
        <!-- Sección izquierda: Formulario para crear nuevo rol -->
        <div class="col-md-6 mb-4">
            <div class="p-4" style="max-height: calc(100vh - 150px); background-color: #f9f9f9; border-radius: 10px; box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.1);">
                <h3 class="mb-3" style="font-size: 18px; font-family: 'Century Gothic', sans-serif; color: #555;font-weight: bold;">Crear Nuevo Rol</h3>
                <form action="/roles/add" method="post">
                    <div class="mb-4">
                        <label for="roleName" class="form-label" style="color: #555;">Nombre del Rol</label>
                        <input type="text" class="form-control" id="roleName" name="role_name" placeholder="Ejemplo: Administrador" style="border-radius: 6px;" required>
                    </div>

                    <div class="mb-4">
                        <label for="permissions" class="form-label" style="color: #555;">Pantallas a Asignar</label>
                        <select multiple class="form-select" name="permissions" id="permissions" style="max-height: calc(100vh - 150px); border-radius: 6px;">
                            {% for pantalla in pantallas %}
                            <option value="{{ pantalla }}">{{ pantalla }}</option>
                            {% endfor %}
                        </select>
                        <small class="form-text text-muted">Mantenga presionado Ctrl o Cmd para seleccionar varias pantallas</small>
                    </div>

                    <div class="text-center">
                        <button type="submit" class="btn btn-success px-4 py-2" style="border-radius: 50px; font-size: 16px;">
                            <i class="fas fa-plus-circle"></i> Crear Rol
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Sección derecha: Tabla de roles existentes con barra de desplazamiento -->
        <div class="col-md-6 mb-4">
            <h3 class="mb-3" style="font-size: 18px; font-family: 'Century Gothic', sans-serif; color: #555;font-weight: bold;">Roles Existentes</h3>
            <div class="table-responsive" style="max-height: 400px; overflow-y: auto;"> <!-- Sección con scroll -->
                <table class="table table-striped table-hover" style="border-radius: 8px;">
                    <thead class="table-dark">
                        <tr>
                            <th scope="col" style="width: 20%;">Rol</th>
                            <th scope="col" style="width: 50%;">Pantallas Asignadas</th> 
                            <th scope="col" class="text-center" style="width: 30%;">Acciones</th> 
                        </tr>
                    </thead>
                    <tbody>
                        {% for role, permissions in roles.items() %}
                        <tr>
                            <td>{{ role }}</td>
                            <td>{{ permissions | join(', ') }}</td>
                            <td class="text-center">
                                <button class="btn btn-sm btn-outline-primary">
                                    <i class="fas fa-edit"></i> Editar
                                </button>
                                <button class="btn btn-sm btn-outline-danger">
                                    <i class="fas fa-trash-alt"></i> Eliminar
                                </button>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
{% endblock %}